# Vehicle Agent Protocol (VAP)

**Vehicle Agent Protocol (VAP)** is an open protocol for communication between intelligent software agents operating in or around vehicles.

It provides a common message format for exchanging information such as events, recommendations, queries and alerts ‚Äî allowing vehicles, fleets, and backend systems to interact in a structured, decentralized and vendor-agnostic way (i.e. not tied to any specific brand or platform).

VAP is designed to support both closed systems and open networks of agents, enabling new forms of vehicle collaboration, predictive maintenance, and shared knowledge between connected actors.


---

## üåê Objectives

- Define a common format for communication between vehicle agents.
- Facilitate interoperability between different agent implementations.
- Enable a decentralized, collaborative network of vehicle assistants.

---

## üõ∞Ô∏è Transport mechanisms

(MQTT, WebSocket, REST) are currently under review ‚Äî see [docs/transport.md](docs/transport.md)

---

## üì¶ Basic Message Structure

```json
{
  "message_id": "msg-981273",
  "timestamp": "2025-05-02T18:32:00Z",
  "sender_id": "vehicle:ABC123",
  "receiver_id": "vehicle:XYZ987",
  "message_type": "event",
  "event": {
    "name": "engine_noise_detected",
    "severity": "medium",
    "location": "engine_bay",
    "confidence": 0.87
  },
  "metadata": {
    "vehicle_model": "Toyota Corolla 2021",
    "agent_version": "1.2.4",
    "language": "en-US"
  }
}
```

---

## üóÇÔ∏è Message Types (`message_type`)

| Type            | Description                                              |
|------------------|----------------------------------------------------------|
| `event`          | Alert or signal generated by an agent                    |
| `query`          | A question sent from one agent to another                |
| `response`       | A reply to a `query` message                             |
| `sync_state`     | Periodic exchange of current status or shared context    |
| `notification`   | General system message (not addressed to a specific agent) |

---

## üìö Full Message Specification

See the [detailed key and message documentation](docs/message-spec.md) for field definitions, optional values, and valid extensions.

---

## üßæ Example: Query and Response Between Agents

### 1. `query`: Request for a recommended workshop in Zaragoza

```json
{
  "message_type": "query",
  "sender_id": "vehicle:ABC123",
  "receiver_id": "vehicle:XYZ987",
  "timestamp": "2025-05-02T17:00:00Z",
  "query": {
    "type": "recommendation",
    "topic": "maintenance_shop",
    "location": "Zaragoza"
  }
}
```

### 2. `response`: Recommendation returned

```json
{
  "message_type": "response",
  "sender_id": "vehicle:XYZ987",
  "receiver_id": "vehicle:ABC123",
  "timestamp": "2025-05-02T17:01:12Z",
  "response": {
    "type": "recommendation",
    "data": {
      "name": "Bosch Service Zaragoza",
      "rating": 4.7,
      "last_used": "2024-12-10"
    }
  }
}
```
---

## üîê Agent Identifier Format

| Identifier Type      | Format Example           | Description                            |
|----------------------|--------------------------|----------------------------------------|
| Vehicle agent        | `vehicle:ABC123`         | Individual vehicle                     |
| Fleet agent          | `fleet:FLEET001`         | Represents a company or rental fleet   |
| User agent           | `user:johndoe`           | A human user                           |
| System/backend agent | `system:autonality.ai`   | Central coordination or orchestration  |

---

## üìò License

This project is licensed under the [MIT License](LICENSE), which permits open use, modification, and distribution with attribution.

---

## ü§ù Contributions

We welcome suggestions, extensions, and compatible agent implementations in any language.  
Feel free to fork this repo, open an issue, or submit a pull request.

---

## üì¨ Contact

Created and maintained by [autonality.ai](https://autonality.ai)  
For questions, suggestions or collaborations, contact: **echacon911@gmail.com**
# Vehicle Agent Protocol ‚Äì Message Specification

This document provides a detailed specification of the message structure used in the Vehicle Agent Protocol (VAP).  
It defines the required and optional fields, valid types, and how to extend the standard in a structured way.

---

## 1. üì¶ Message Overview

All VAP messages are JSON objects with a standard set of top-level fields and an optional nested payload, depending on the message type.

---

## 2. üîë Top-Level Fields

| Key            | Type     | Required | Description                                                                 |
|----------------|----------|----------|-----------------------------------------------------------------------------|
| `message_id`   | string   | No       | Unique ID of the message (e.g., UUID or internal ref).                     |
| `timestamp`    | string   | Yes      | ISO 8601 format datetime when the message was generated.                   |
| `sender_id`    | string   | Yes      | Unique ID of the agent sending the message. Format: `vehicle:X`, `fleet:Y`, etc. |
| `receiver_id`  | string   | Yes      | ID of the target agent. Can be another vehicle, fleet, user, or system.    |
| `message_type` | string   | Yes      | One of: `event`, `query`, `response`, `sync_state`, `notification`.        |

---

## 3. üß© Message Type Definitions

### 3.1 `event`

Used when an agent reports a detected condition or signal.

```json
"event": {
  "name": "engine_noise_detected",
  "severity": "medium",
  "location": "engine_bay",
  "confidence": 0.87
}
```

| Field       | Type     | Required | Description                                       |
|-------------|----------|----------|---------------------------------------------------|
| `name`      | string   | Yes      | Event identifier (e.g., `brake_pad_wear`)         |
| `severity`  | string   | No       | `low`, `medium`, `high`                           |
| `location`  | string   | No       | Physical or logical location                      |
| `confidence`| number   | No       | Value from 0.0 to 1.0                             |

---

### 3.2 `query`

Used when an agent requests information, suggestions, or status.

```json
"query": {
  "type": "recommendation",
  "topic": "maintenance_shop",
  "location": "Zaragoza"
}
```

| Field      | Type     | Required | Description                                            |
|------------|----------|----------|--------------------------------------------------------|
| `type`     | string   | Yes      | `recommendation`, `data_request`, `fleet_status`, etc.|
| `topic`    | string   | Yes      | The subject of the query                              |
| `location` | string   | No       | Optional context                                       |

---

### 3.3 `response`

Used to return data in response to a query.

```json
"response": {
  "type": "recommendation",
  "data": {
    "name": "Bosch Service Zaragoza",
    "rating": 4.7,
    "last_used": "2024-12-10"
  }
}
```

| Field   | Type     | Required | Description                                  |
|---------|----------|----------|----------------------------------------------|
| `type`  | string   | Yes      | Must match the original query‚Äôs `type`       |
| `data`  | object   | Yes      | Payload with the response                    |

---

### 3.4 `sync_state` (reserved)

This message type is **reserved for future use**, such as:
- Sharing a vehicle's current state with a fleet backend.
- Broadcasting contextual state to nearby agents.

Structure to be defined in a future version.

---

### 3.5 `notification` (reserved)

This message type is **intended for system-wide notifications** or status messages not directed to any specific agent.

Examples (future use):
- Service downtime alert
- Protocol version update
- Public safety broadcast

Structure to be defined in a future version.

---

## 4. ‚ÑπÔ∏è `metadata` Object

Provides contextual information about the sending agent.

```json
"metadata": {
  "vehicle_model": "Hyundai Ioniq 5",
  "agent_version": "1.2.4",
  "language": "es-ES"
}
```

| Field           | Type     | Description                                |
|------------------|----------|--------------------------------------------|
| `vehicle_model`  | string   | e.g., `Toyota Corolla 2021`                |
| `agent_version`  | string   | e.g., `1.3.2`                              |
| `language`       | string   | Language code (e.g., `en-US`, `es-ES`)     |

---

### 4.1 üåç About `language` and Multilingual Support

The `metadata.language` field specifies the preferred language for human-facing communication.

#### ‚úÖ Keys and Values Stay in English

Even when `language` is `es-ES` or another non-English value, all **field names and enum values remain in English**. This ensures:

- Global interoperability
- Stable validation against schemas
- Avoiding ambiguity in parsing

| Element            | Language   | Example                       |
|--------------------|------------|-------------------------------|
| Keys / field names | English    | `event`, `query.topic`, etc.  |
| Enum values        | English    | `"brake_pad_wear"`, `"high"`  |
| Language metadata  | Any valid  | `"language": "es-ES"`         |
| Generated output   | User's lang| Response in Spanish, if needed|

---

## 5. üìö Supported `query.type` Values

| Type              | Description                                               |
|-------------------|-----------------------------------------------------------|
| `recommendation`  | Ask for suggestions based on experience                   |
| `data_request`    | Request technical/vehicle data                            |
| `fleet_status`    | Ask for status summary from a fleet agent                 |
| `vehicle_identity`| Ask for metadata about another vehicle                    |
| `proximity_alert` | Ask for nearby agents                                     |

You are encouraged to propose more types through GitHub Issues or Pull Requests.

---

## 6. ‚öôÔ∏è Extending the Standard

- Use `custom_` prefixes for any new fields.
- Agents must ignore unknown fields to remain forward-compatible.
- Validate messages using the official schema: [`schema/VAP-message-schema.json`](../schema/VAP-message-schema.json)

---

## 7. üß™ Message Validation

Use the provided Python script to validate example messages:

```bash
python validate_message.py examples/query.json
```

---

## 8. üì¨ Feedback & Contributions

This specification is open and evolving.  
Submit ideas, issues, or PRs at: [https://github.com/autonalityAI/vehicle-agent-standard](https://github.com/autonalityAI/vehicle-agent-standard)

---

## 9. üìÑ Changelog

See [CHANGELOG.md](CHANGELOG.md) for a list of releases and updates to the standard.
